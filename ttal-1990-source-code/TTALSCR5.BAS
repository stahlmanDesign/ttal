DECLARE SUB CREATURES ()
DECLARE SUB PUTSHAPETWO ()
DECLARE SUB SAVESCREENTWO ()
DECLARE SUB PUTBLOCKTWO ()
DECLARE SUB DRAWSANDGETS ()
DECLARE SUB CURSORLEFT ()
DECLARE SUB CURSORUP ()
DECLARE SUB CURSORRIGHT ()
DECLARE SUB CURSORDOWN ()
DECLARE SUB PUTBLOCK ()
DECLARE SUB PUTBLOCKTWO ()
DECLARE SUB SAVESCREENTWO ()
DECLARE SUB SAVESCREEN ()
DECLARE SUB EDITMENU ()
DECLARE SUB PUTSHAPE ()
DECLARE SUB CONSTRUCT ()

     COMMON SHARED A0(), A1(), A2(), B0(), B1(), B2(), C0(), C1(), C2(), D0(), D1(), D2(), E0(), E1(), E2(), F0(), F1(), F2(), G1(), G2(), I1(), I2(), K1(), K2(), M1(), M2(), O1(), Q1(), Q2(), Q3(), P1(), P2(), P3(), H(), J(), L(), N(), P(), BO()
     COMMON SHARED A, B, NU
     COMMON SHARED SH, QL
     COMMON SHARED XO
     COMMON SHARED XP
     COMMON SHARED XQ
     COMMON SHARED YO
     COMMON SHARED YP
     COMMON SHARED YQ
     COMMON SHARED U1, U2, U3, U4, U5, U6, U7, U8, U9, UT
     COMMON SHARED X1, X2, Y1, Y2, W1, W2, D1, D2, S1, S2, K1, K2, D, L, F1, F2, F3, B1, B2, B3
     COMMON SHARED TA, TB

     'VECTORS DIMENSIONS
  
     DIM A0(10, 14), A1(10, 14), A2(10, 14), B0(10, 14), B1(10, 14), B2(10, 14), C0(12, 14), C1(12, 14), C2(12, 14), D0(12, 14), D1(12, 14), D2(12, 14), E0(20, 14), E1(20, 14), E2(20, 14), F0(20, 14), F1(20, 14), F2(20, 14)
     DIM G1(16, 14), G2(16, 14), I1(16, 14), I2(16, 14), K1(11, 23), K2(11, 23), M1(9, 13), M2(9, 13), O1(20, 10), Q1(4, 4), Q2(4, 4), Q3(4, 4), P1(10, 10), P2(10, 10), P3(10, 10)
     DIM P(10, 40)
     'NON-MOVING OBJECTS DIMENSIONS
     DIM H(10, 40), J(20, 10), L(10, 10), N(10, 10)
     DIM BO(10, 10)

     SH = 1
     U1 = 1: U2 = 1: U3 = 1: U4 = 1: U5 = 1: U6 = 1: U7 = 1: U8 = 1: U9 = 1: UT = 1

DRAWSANDGETS

1 '
EDITMENU

CLS
LOCATE 25, 1: INPUT "Enter screen number to edit: ", NU
CLS
LOCATE 25, 1: PRINT "Editing TTALSCRN screen"; NU

          A$ = "TTALSCRN" + STR$(NU)
          FOR Q = 1 TO LEN(A$)
          IF MID$(A$, Q, 1) = " " THEN MID$(A$, Q, 1) = "."
          NEXT

OPEN A$ FOR APPEND AS 1: CLOSE 1
OPEN A$ FOR INPUT AS 1: IF EOF(1) = -1 THEN 11
CLOSE 1
OPEN A$ FOR INPUT AS 1

FOR QL = 1 TO 7

DO WHILE EOF(1) <> -1

INPUT #1, A
IF EOF(1) = -1 THEN QL = 8: EXIT DO
INPUT #1, B

IF A = -1 OR B = -1 THEN IF EOF(1) = -1 THEN QL = 7: EXIT DO
IF A = -1 OR B = -1 THEN EXIT DO

IF QL = 1 THEN PUT (A, B), L
IF QL = 2 THEN PUT (A, B), J
IF QL = 3 THEN PUT (A, B), P
IF QL = 4 THEN PUT (A, B - 3), N
IF QL = 5 THEN PUT (A, B), P1
IF QL = 6 THEN PUT (A, B), P2
IF QL = 7 THEN PUT (A, B), P3

LOOP
NEXT
CLOSE 1

11 '
CLOSE 1

A = 10: B = 180

PUTBLOCK
LINE (0, 0)-(9, 9), 0, B

DO WHILE A$ <> "Q"
A$ = INKEY$

IF A$ = "4" THEN CURSORLEFT: A = A - 10: IF A < 10 THEN A = 300
IF A$ = "8" THEN CURSORUP: B = B - 10: IF B < 10 THEN B = 180
IF A$ = "6" THEN CURSORRIGHT: A = A + 10: IF A > 300 THEN A = 10
IF A$ = "2" THEN CURSORDOWN: B = B + 10: IF B > 180 THEN B = 10
IF A$ = " " THEN PUTSHAPE
IF A$ = "S" THEN SAVESCREEN: GOTO 1
IF A$ = "E" THEN FOR Q = 1 TO 24: PRINT "                                        ": NEXT
IF A$ = "A" THEN GOTO 1
IF A$ = "C" THEN SH = SH + 1: IF SH = 8 THEN SH = 1
A = A: B = B: PUTBLOCK
LOCATE 25, 28: PRINT A; ","; B; "  ";
LOOP

SUB CONSTRUCT
SCREEN 7: COLOR 0, 0
CLS
SC = 0: RN = 9: S = 0
FOR Q = 0 TO 319: COLOR 8: LINE (Q, 0)-(Q, 199): Q = Q + 30: NEXT
FOR Q = 0 TO 199: COLOR 8: LINE (0, Q)-(319, Q): Q = Q + 18: NEXT

FOR QQ = 1 TO 6

     FOR NU = SC TO RN
    
          A$ = "TTALSCRN" + STR$(NU)
          FOR Q = 1 TO LEN(A$)
          IF MID$(A$, Q, 1) = " " THEN MID$(A$, Q, 1) = "."
          NEXT
          OPEN A$ FOR APPEND AS 2: CLOSE 2
          OPEN A$ FOR INPUT AS 2

FOR QL = 1 TO 7

DO WHILE EOF(2) <> -1

INPUT #2, X, Y

9 IF X = -1 OR Y = -1 THEN IF EOF(2) = -1 THEN EXIT DO
IF X = -1 OR Y = -1 THEN QL = QL + 1
IF X = -1 OR Y = -1 THEN INPUT #2, X, Y: IF X = -1 OR Y = -1 THEN 9

X = X / 10: Y = Y / 10

IF NU > SC THEN X = X + 31
IF NU > SC + 1 THEN X = X + 31
IF NU > SC + 2 THEN X = X + 31
IF NU > SC + 3 THEN X = X + 31
IF NU > SC + 4 THEN X = X + 31
IF NU > SC + 5 THEN X = X + 31
IF NU > SC + 6 THEN X = X + 31
IF NU > SC + 7 THEN X = X + 31
IF NU > SC + 8 THEN X = X + 31
IF NU > SC + 9 THEN X = X + 31

IF X = -1 OR Y = -1 THEN IF EOF(1) = -1 THEN EXIT DO
IF X = -1 OR Y = -1 THEN EXIT DO

IF QL = 1 THEN COLOR 6: PSET (X, Y + S)
IF QL = 2 THEN COLOR 6: LINE (X, Y + S)-(X + 1, Y + S)
IF QL = 3 THEN COLOR 15: LINE (X, Y + S)-(X, Y + (3 + S))
IF QL = 4 THEN COLOR 10: PSET (X, Y + S)
IF QL = 5 THEN COLOR 2: PSET (X, Y + S)
IF QL = 6 THEN COLOR 3: PSET (X, Y + S)
IF QL = 7 THEN COLOR 13: PSET (X, Y + S)
B$ = INKEY$: IF B$ = " " THEN RUN
LOOP
NEXT
CLOSE 2
NEXT
SC = SC + 10: RN = RN + 10: S = S + 19
NEXT
LOCATE 25, 1: INPUT A$
END SUB

SUB CREATURES
X1 = 0: Y1 = 0
X2 = 0: Y2 = 0
W1 = 0: D1 = 0
W2 = 0: D2 = 0
S1 = 0: K1 = 0
S2 = 0: K2 = 0
D = 0: L = 0
F1 = 0: B1 = 0
F2 = 0: B2 = 0
F3 = 0: B3 = 0

CLS
LOCATE 25, 1: INPUT "Screen number for creatures: ", NU
CLS
LOCATE 25, 1: PRINT "Editing TTALCREA screen"; NU

          A$ = "TTALSCRN" + STR$(NU)       'TRUST ME, THIS FILENAME IS RIGHT
          FOR Q = 1 TO LEN(A$)
          IF MID$(A$, Q, 1) = " " THEN MID$(A$, Q, 1) = "."
          NEXT

OPEN A$ FOR APPEND AS 1: CLOSE 1
OPEN A$ FOR INPUT AS 1: IF EOF(1) = -1 THEN 13
CLOSE 1
OPEN A$ FOR INPUT AS 1

FOR QL = 1 TO 7

DO WHILE EOF(1) <> -1

INPUT #1, A
IF EOF(1) = -1 THEN QL = 8: EXIT DO
INPUT #1, B

IF A = -1 OR B = -1 THEN IF EOF(1) = -1 THEN QL = 7: EXIT DO
IF A = -1 OR B = -1 THEN EXIT DO

IF QL = 1 THEN PUT (A, B), L
IF QL = 2 THEN PUT (A, B), J
IF QL = 3 THEN PUT (A, B), P
IF QL = 4 THEN PUT (A, B - 3), N
IF QL = 5 THEN PUT (A, B), P1
IF QL = 6 THEN PUT (A, B), P2
IF QL = 7 THEN PUT (A, B), P3

LOOP
NEXT
CLOSE 1

13 '
CLOSE 1
         
         
         

A = 10: B = 180

PUTBLOCK
LINE (0, 0)-(9, 9), 0, B

DO WHILE A$ <> "Q"
A$ = INKEY$

IF A$ = "4" THEN CURSORLEFT: A = A - 10: IF A < 10 THEN A = 300
IF A$ = "8" THEN CURSORUP: B = B - 10: IF B < 10 THEN B = 180
IF A$ = "6" THEN CURSORRIGHT: A = A + 10: IF A > 300 THEN A = 10
IF A$ = "2" THEN CURSORDOWN: B = B + 10: IF B > 180 THEN B = 10
IF A$ = " " THEN PUTSHAPETWO
IF A$ = "S" THEN SAVESCREENTWO: EXIT SUB
IF A$ = "A" THEN EXIT SUB
IF A$ = "C" THEN SH = SH + 1: IF SH >= 11 THEN SAVESCREENTWO: SH = 1: EXIT SUB

PUTBLOCKTWO
LOCATE 25, 28: PRINT A; ","; B; "  ";
LOOP

END SUB

SUB CURSORDOWN
END SUB

SUB CURSORLEFT
END SUB

SUB CURSORRIGHT
END SUB

SUB CURSORUP
END SUB

SUB DRAWSANDGETS
   
Apage% = 1: Vpage% = 2
    
     SCREEN 7, , Apage%, Vpage%
     COLOR 5, 7
     CLS 1

     COLOR 5, 7
 
'OBJECT SHAPES HERE --- MAN (0, 1, 2), WINGED DEMON (1, 2), SKULL (1, 2)
'                   --- DEMONLORD (1), FIREBALL(1, 2, 3)
            

                         'MAN0 RIGHT & LEFT POSE #1

     DRAW "BM 0,0 C14 DFDDFDDFFEEGGEE C8 U3LURUULRRDRDLDDRD4LLDRDLRDLDRDL3"
     GET (0, 0)-(10, 15), A0
     DRAW "BM 19,0 C14 DGDDGDDGGHHFFHH C8 U3RULUURLLDLDRDDLD4RRDLDRLDRDLDR3"
     GET (11, 0)-(19, 14), B0
  
                         'MAN0 RIGHT & LEFT POSE #2

     DRAW "BM 0,16 C14 F6GEEG C8 FEU3LURUULRRDRUDLDDRDDDDLLDLDDLDDLLRRUURUURRDRDRDDL"
     DRAW "BM 10,16 C0 D C8 L BM 9,20 C8 DDL"
     GET (0, 16)-(11, 29), C0
     DRAW "BM 23,16 C14 G6FHEFG C8 HU3RULUURLLDLUDRDDLDDDDRRDRDDRDDRRLLUULUULLDLDLDDR"
     DRAW "BM 15,16 C0 D C8 R BM 16,20 C8 DDR"
     GET (13, 16)-(23, 29), D0
                      
                         'MAN0 RIGHT & LEFT STAB POSE

     DRAW "BM 0,37 C14 R9UDDUR C8 RRRDU3LULURUULRRDRDLDRDRDLR5DRLULLLDLLDRRDDRD3RRLLUUULULLDLDLDDLL"
     GET (0, 31)-(20, 43), E0
     DRAW "BM 43,37 C14 L9UDDUL C8 LLLDU3RURULUURLLDLDRDLDLDRL5DLRURRRDRRDLLDDLD3LLRRUUURURRDRDRDDRR"
     GET (21, 31)-(43, 43), F0

                         'MAN1 RIGHT & LEFT POSE #1

     DRAW "BM 0,0 C14 DFDDFDDFFEEGGEE C9 U3LURUULRRDRDLDDRD4LLDRDLRDLDRDL3"
     GET (0, 0)-(10, 15), A1
     DRAW "BM 19,0 C14 DGDDGDDGGHHFFHH C9 U3RULUURLLDLDRDDLD4RRDLDRLDRDLDR3"
     GET (11, 0)-(19, 14), B1

                         'MAN1 RIGHT & LEFT POSE #2

     DRAW "BM 0,16 C14 F6GEEG C9 FEU3LURUULRRDRUDLDDRDDDDLLDLDDLDDLLRRUURUURRDRDRDDL"
     DRAW "BM 10,16 C0 D C9 L BM 9,20 C9 DDL"
     GET (0, 16)-(11, 29), C1
     DRAW "BM 23,16 C14 G6FHEFG C9 HU3RULUURLLDLUDRDDLDDDDRRDRDDRDDRRLLUULUULLDLDLDDR"
     DRAW "BM 15,16 C0 D C9 R BM 16,20 C9 DDR"
     GET (13, 16)-(23, 29), D1

                         'MAN1 RIGHT & LEFT STAB POSE

     DRAW "BM 0,37 C14 R9UDDUR C9 RRRDU3LULURUULRRDRDLDRDRDLR5DRLULLLDLLDRRDDRD3RRLLUUULULLDLDLDDLL"
     GET (0, 31)-(20, 43), E1
     DRAW "BM 43,37 C14 L9UDDUL C9 LLLDU3RURULUURLLDLDRDLDLDRL5DLRURRRDRRDLLDDLD3LLRRUUURURRDRDRDDRR"
     GET (21, 31)-(43, 43), F1

                         'MAN2 RIGHT & LEFT POSE #1

     DRAW "BM 0,0 C14 DFDDFDDFFEEGGEE C10 U3LURUULRRDRDLDDRD4LLDRDLRDLDRDL3"
     GET (0, 0)-(10, 15), A2
     DRAW "BM 19,0 C14 DGDDGDDGGHHFFHH C10 U3RULUURLLDLDRDDLD4RRDLDRLDRDLDR3"
     GET (11, 0)-(19, 14), B2

                         'MAN2 RIGHT & LEFT POSE #2

     DRAW "BM 0,16 C14 F6GEEG C10 FEU3LURUULRRDRUDLDDRDDDDLLDLDDLDDLLRRUURUURRDRDRDDL"
     DRAW "BM 10,16 C0 D C10 L BM 9,20 C10 DDL"
     GET (0, 16)-(11, 29), C2
     DRAW "BM 23,16 C14 G6FHEFG C10 HU3RULUURLLDLUDRDDLDDDDRRDRDDRDDRRLLUULUULLDLDLDDR"
     DRAW "BM 15,16 C0 D C10 R BM 16,20 C10 DDR"
     GET (13, 16)-(23, 29), D2

                         'MAN2 RIGHT & LEFT STAB POSE

     DRAW "BM 0,37 C14 R9UDDUR C10 RRRDU3LULURUULRRDRDLDRDRDLR5DRLULLLDLLDRRDDRD3RRLLUUULULLDLDLDDLL"
     GET (0, 31)-(20, 43), E2
     DRAW "BM 43,37 C14 L9UDDUL C10 LLLDU3RURULUURLLDLDRDLDLDRL5DLRURRRDRRDLLDDLD3LLRRUUURURRDRDRDDRR"
     GET (21, 31)-(43, 43), F2

                         'WINGED DEMON1 POSE #1

     DRAW "BM 26,1 C15 FDRDRDLRRDL BM 40,1 C15 GDLDLDLDRUR BM 32,7 RR BM 32,5 C4 DFEUDGDRDLDULUHGDDGDD BM 35,7 C4 FDDGG BM 37,12 C14 L2 BM 33,12 L5HHLRFDLLRRDGL"
     GET (25, 0)-(40, 14), G1

                         'WINGED DEMON1 POSE #2

     DRAW "BM 28,16 C15 DFDDRDLRD BM 38,16 DGDDLDDUR BM 32,23 R3 BM 32,21 C4 DFEUDGDRDLDULUHGDGDD BM 35,23 FDDGG BM 37,29 C14 LL BM 33,28 C14 LHLLLHHLRFDLLRRDGL"
     GET (25, 16)-(40, 29), I1

                         'WINGED DEMON1 STAB POSE

     DRAW "BM 45,0 C15 DFDDRDLRD BM 55,0 C15 DGDDLDDUR BM 49,7 C15 RR BM 49,5 C4 DFEUDGDRDLDULUHGDDFFFRUEEUUH BM 50,11 C14 D BM 50,14 D4GGDDUUERDDDUUURFDD"
     GET (45, 0)-(55, 22), K1

                         'WINGED DEMON2 POSE #1

     DRAW "BM 26,1 C15 FDRDRDLRRDL BM 40,1 C15 GDLDLDLDRUR BM 32,7 RR BM 32,5 C12 DFEUDGDRDLDULUHGDDGDD BM 35,7 C4 FDDGG BM 37,12 C14 L2 BM 33,12 L5HHLRFDLLRRDGL"
     GET (25, 0)-(40, 14), G2

                         'WINGED DEMON2 POSE #2

     DRAW "BM 28,16 C15 DFDDRDLRD BM 38,16 DGDDLDDUR BM 32,23 R3 BM 32,21 C12 DFEUDGDRDLDULUHGDGDD BM 35,23 FDDGG BM 37,29 C14 LL BM 33,28 C14 LHLLLHHLRFDLLRRDGL"
     GET (25, 16)-(40, 29), I2

                         'WINGED DEMON2 STAB POSE

     DRAW "BM 45,0 C15 DFDDRDLRD BM 55,0 C15 DGDDLDDUR BM 49,7 C15 RR BM 49,5 C12 DFEUDGDRDLDULUHGDDFFFRUEEUUH BM 50,11 C14 D BM 50,14 D4GGDDUUERDDDUUURFDD"
     GET (45, 0)-(55, 22), K2

                         'SKULL1 POSE

     DRAW "BM 48,24 C8 RRRRDRLLLLLLDRLDLDRDLRRRRUUUDDDRRRRULURLULURDDDDDLDRDLDDDULUULUUUDDDDLULDDUULURULURRRLLLLURUL BM 49,28 C15 HDRRRRU BM 50,27 C1 DD"
     DRAW "BM 49,26 C8 D BM 51,26 D BM 49,30 C8 D BM 51,30 C8 D"
     GET (46, 24)-(54, 36), M1

                         'SKULL2 POSE

     DRAW "BM 48,24 C15 RRRRDRLLLLLLDRLDLDRDLRRRRUUUDDDRRRRULURLULURDDDDDLDRDLDDDULUULUUUDDDDLULDDUULURULURRRLLLLURUL BM 49,28 C7 HDRRRRU BM 50,27 C15 DD"
     DRAW "BM 49,26 C15 D BM 51,26 D BM 49,30 C15 D BM 51,30 C15 D"
     GET (46, 24)-(54, 36), M2


                         'DEMONLORD POSE

     DRAW "BM 46,39 C14 FRDRDRDR C4 DUDRLLLRDRRDLLLDLRURRDDRLDDRLDDRLDRRDLRRDLRDUR C14 EUHEHEHEH BM 42,53 C4 RDLRRRRULRRULRRULRUURDDRUUDDDDDLDRDRDRDLDRRFHLLLDLL C14 RLRR BM 49,45 C15 R"
     GET (42, 39)-(56, 60), O1

                         'FIREBALL1 POSE
     CLS 1
     CIRCLE (5, 5), 2, 14: PAINT (5, 5), 14, 14
     GET (0, 0)-(10, 10), Q1
                      
                         'FIREBALL2 POSE
   
     CIRCLE (15, 5), 3, 12: PAINT (15, 5), 12, 12
     GET (10, 0)-(20, 10), Q2

                         'FIREBALL3 POSE
   
     CIRCLE (25, 5), 4, 4: PAINT (25, 5), 4, 4
     GET (20, 0)-(30, 10), Q3

'NON-MOVING OBJECTS HERE --- PILLAR (1), STALACTITE GROUND (1)
'                        --- SOLID GROUND (1), GRASS (1), POTION (1, 2, 3)

                         'PILLAR POSE

     DRAW "BM 58,0 C6 R9LD C8 L7RD37LDLRRRRRRRRRLULLLLLLRRU37RRD37 BM 61,2 C15 D35 BM 63,2 C15 D35 BM 65,2 C15 D35"
     DRAW "BM 59,1 C6 R7"
     GET (58, 0)-(67, 39), P

                         'STALACTITE GROUND POSE

     DRAW "BM 0,50 C6 R19DDDDDULLDDDLDDDUUULUUULLDLDDDULULLDDDUULULLDDULLDDUULUULUULLDDDUUUUUU BM 1,51 P6,6"
     GET (0, 50)-(19, 60), J

                         'SOLID GROUND POSE

     DRAW "BM 21,50 C6 FERRRRDRRRUDLDDRDDLDFDDLULLDLLLLULLUUURUULURURRRR"
     PAINT (25, 55), 6, 6
     GET (21, 50)-(30, 59), L

                         'GRASS POSE

     DRAW "BM 31,57 C2 FDLRRRURDRUDRRUDRRE"
     GET (31, 57)-(40, 60), N
                         'POTION1 POSE
                      
     DRAW "BM 60,50 C8 RRRRLD C2 LLDRRDLLDLDLDDLRDRDRRRRULLLRRRRURLULDLRURUHLUDDLDLDLUURUR BM 63,58 C15 EE"
     GET (58, 50)-(67, 59), P1
                      
                         'POTION2 POSE

     DRAW "BM 60,50 C8 RRRRLD C3 LLDRRDLLDLDLDDLRDRDRRRRULLLRRRRURLULDLRURUHLUDDLDLDLUURUR BM 63,58 C15 EE"
     GET (58, 50)-(67, 59), P2
                      
                         'POTION3 POSE

     DRAW "BM 60,50 C8 RRRRLD C13 LLDRRDLLDLDLDDLRDRDRRRRULLLRRRRURLULDLRURUHLUDDLDLDLUURUR BM 63,58 C15 EE"
     GET (58, 50)-(67, 59), P3
    
                         'BOX

     CLS 1

     COLOR 8
     LINE (0, 0)-(0 + 9, 0 + 9), 8, B
     GET (0, 0)-(10, 10), BO

END SUB

SUB EDITMENU

8  SCREEN 7, , 0, 0: COLOR 1, 7
    
     CLS : LOCATE 3, 1
     PRINT "             Main Menu"
     PRINT "1 = Draw"
     PRINT
     PRINT "2 = End"
     PRINT
     PRINT "3 = See available keys"
     PRINT
     PRINT "4 = Construct game map"
     PRINT
     PRINT "5 = Draw creatures"
     PRINT
     PRINT : INPUT "ENTER CHOICE: ", CH
     IF CH = 1 THEN EXIT SUB
     IF CH = 2 THEN SYSTEM
     IF CH = 3 THEN LOCATE 24, 1: PRINT "4 = Left"
     IF CH = 3 THEN PRINT "8 = Up"
     IF CH = 3 THEN PRINT "6 = Right"
     IF CH = 3 THEN PRINT "2 = Down"
     IF CH = 3 THEN PRINT "(SPACE)= Plot shape"
     IF CH = 3 THEN PRINT
     IF CH = 3 THEN PRINT "S = Save screen"
     IF CH = 3 THEN PRINT "E = Clear screen"
     IF CH = 3 THEN PRINT "A = Abort editing & go back to menu"
     IF CH = 3 THEN PRINT "C = Change shape"
     IF CH = 3 THEN INPUT Q$: GOTO 8
     IF CH = 4 THEN CONSTRUCT
     IF CH = 5 THEN 20
GOTO 8

20 CREATURES

GOTO 8
END SUB

SUB PUTBLOCK

     PUT (A, B), BO
     'FOR Q = 1 TO 30: NEXT
     PUT (A, B), BO

IF SH = 1 THEN PUT (A, B), L: FOR Q = 1 TO 30: NEXT: PUT (A, B), L
IF SH = 2 THEN PUT (A, B - 3), N: FOR Q = 1 TO 30: NEXT: PUT (A, B - 3), N
IF SH = 3 THEN IF A < 300 THEN PUT (A, B), J: FOR Q = 1 TO 30: NEXT: PUT (A, B), J
IF SH = 4 THEN IF B < 160 THEN PUT (A, B), P: FOR Q = 1 TO 30: NEXT: PUT (A, B), P
IF SH = 5 THEN PUT (A, B), P1: FOR Q = 1 TO 30: NEXT: PUT (A, B), P1
IF SH = 6 THEN PUT (A, B), P2: FOR Q = 1 TO 30: NEXT: PUT (A, B), P2
IF SH = 7 THEN PUT (A, B), P3: FOR Q = 1 TO 30: NEXT: PUT (A, B), P3
'IF SH = 8 THEN PUT (A, B), D1: FOR Q = 1 TO 30: NEXT: PUT (A, B), D1
'IF SH = 9 THEN PUT (A, B), D2: FOR Q = 1 TO 30: NEXT: PUT (A, B), D2
'IF SH = 10 THEN PUT (A, B), K1: FOR Q = 1 TO 30: NEXT: PUT (A, B), K1
'IF SH = 11 THEN PUT (A, B), K2: FOR Q = 1 TO 30: NEXT: PUT (A, B), K2
'IF SH = 12 THEN PUT (A, B), M1: FOR Q = 1 TO 30: NEXT: PUT (A, B), M1
'IF SH = 13 THEN PUT (A, B), M2: FOR Q = 1 TO 30: NEXT: PUT (A, B), M2
'IF SH = 14 THEN IF B < 170 THEN PUT (A, B), O1: FOR Q = 1 TO 30: NEXT: PUT (A, B), O1
'IF SH = 15 THEN PUT (A, B), Q1: FOR Q = 1 TO 30: NEXT: PUT (A, B), Q1
'IF SH = 16 THEN PUT (A, B), Q2: FOR Q = 1 TO 30: NEXT: PUT (A, B), Q2
'IF SH = 17 THEN PUT (A, B), Q3: FOR Q = 1 TO 30: NEXT: PUT (A, B), Q3
 
END SUB

SUB PUTBLOCKTWO


     PUT (A, B), BO
     'FOR Q = 1 TO 30: NEXT
     PUT (A, B), BO

'IF SH = 1 THEN PUT (A, B), L: FOR Q = 1 TO 30: NEXT: PUT (A, B), L
'IF SH = 2 THEN PUT (A, B - 3), N: FOR Q = 1 TO 30: NEXT: PUT (A, B - 3), N
'IF SH = 3 THEN IF A < 300 THEN PUT (A, B), J: FOR Q = 1 TO 30: NEXT: PUT (A, B), J
'IF SH = 4 THEN IF B < 160 THEN PUT (A, B), P: FOR Q = 1 TO 30: NEXT: PUT (A, B), P
'IF SH = 5 THEN PUT (A, B), P1: FOR Q = 1 TO 30: NEXT: PUT (A, B), P1
'IF SH = 6 THEN PUT (A, B), P2: FOR Q = 1 TO 30: NEXT: PUT (A, B), P2
'IF SH = 7 THEN PUT (A, B), P3: FOR Q = 1 TO 30: NEXT: PUT (A, B), P3
IF SH = 1 THEN PUT (A, B), D1: FOR Q = 1 TO 30: NEXT: PUT (A, B), D1
IF SH = 2 THEN PUT (A, B), D2: FOR Q = 1 TO 30: NEXT: PUT (A, B), D2
IF SH = 3 THEN IF B < 170 THEN PUT (A, B), K1: FOR Q = 1 TO 30: NEXT: PUT (A, B), K1
IF SH = 4 THEN IF B < 170 THEN PUT (A, B), K2: FOR Q = 1 TO 30: NEXT: PUT (A, B), K2
IF SH = 5 THEN PUT (A, B), M1: FOR Q = 1 TO 30: NEXT: PUT (A, B), M1
IF SH = 6 THEN PUT (A, B), M2: FOR Q = 1 TO 30: NEXT: PUT (A, B), M2
IF SH = 7 THEN IF B < 170 THEN PUT (A, B), O1: FOR Q = 1 TO 30: NEXT: PUT (A, B), O1
IF SH = 8 THEN PUT (A, B), Q1: FOR Q = 1 TO 30: NEXT: PUT (A, B), Q1
IF SH = 9 THEN PUT (A, B), Q2: FOR Q = 1 TO 30: NEXT: PUT (A, B), Q2
IF SH = 10 THEN PUT (A, B), Q3: FOR Q = 1 TO 30: NEXT: PUT (A, B), Q3

END SUB

SUB PUTSHAPE

IF SH = 1 THEN PUT (A, B), L
IF SH = 2 THEN PUT (A, B - 3), N
IF SH = 3 THEN IF A < 300 THEN PUT (A, B), J
IF SH = 4 THEN IF B < 160 THEN PUT (A, B), P
IF SH = 5 THEN PUT (A, B), P1
IF SH = 6 THEN PUT (A, B), P2
IF SH = 7 THEN PUT (A, B), P3
'IF SH = 8 THEN PUT (A, B), D1: U1 = U1 * -1: X1 = A: Y1 = B
'IF SH = 9 THEN PUT (A, B), D2: U2 = U2 * -1: X2 = A: Y2 = B
'IF SH = 10 THEN PUT (A, B), K1: U3 = U3 * -1: W1 = A: D1 = B
'IF SH = 11 THEN PUT (A, B), K2: U4 = U4 * -1: W2 = A: D2 = B
'IF SH = 12 THEN PUT (A, B), M1: U5 = U5 * -1: S1 = A: K1 = B
'IF SH = 13 THEN PUT (A, B), M2: U6 = U6 * -1: S2 = A: K2 = B
'IF SH = 14 THEN IF B < 170 THEN PUT (A, B), O1: U7 = U7 * -1: D = A: L = B
'IF SH = 15 THEN PUT (A, B), Q1: U8 = U8 * -1: F1 = A: B1 = B
'IF SH = 16 THEN PUT (A, B), Q2: U9 = U9 * -1: F2 = A: B2 = B
'IF SH = 17 THEN PUT (A, B), Q3: UT = UT * -1: F3 = A: B3 = B


END SUB

SUB PUTSHAPETWO

'IF SH = 1 THEN PUT (A, B), L
'IF SH = 2 THEN PUT (A, B - 3), N
'IF SH = 3 THEN IF A < 300 THEN PUT (A, B), J
'IF SH = 4 THEN IF B < 160 THEN PUT (A, B), P
'IF SH = 5 THEN PUT (A, B), P1
'IF SH = 6 THEN PUT (A, B), P2
'IF SH = 7 THEN PUT (A, B), P3
IF SH = 1 THEN PUT (A, B), D1: U1 = U1 * -1: X1 = A: Y1 = B: SH = SH + 1: EXIT SUB
IF SH = 2 THEN PUT (A, B), D2: U2 = U2 * -1: X2 = A: Y2 = B: SH = SH + 1: EXIT SUB
IF SH = 3 THEN PUT (A, B), K1: U3 = U3 * -1: W1 = A: D1 = B: SH = SH + 1: EXIT SUB
IF SH = 4 THEN PUT (A, B), K2: U4 = U4 * -1: W2 = A: D2 = B: SH = SH + 1: EXIT SUB
IF SH = 5 THEN PUT (A, B), M1: U5 = U5 * -1: S1 = A: K1 = B: SH = SH + 1: EXIT SUB
IF SH = 6 THEN PUT (A, B), M2: U6 = U6 * -1: S2 = A: K2 = B: SH = SH + 1: EXIT SUB
IF SH = 7 THEN IF B < 170 THEN PUT (A, B), O1: U7 = U7 * -1: D = A: L = B: SH = SH + 1: EXIT SUB
IF SH = 8 THEN PUT (A, B), Q1: U8 = U8 * -1: F1 = A: B1 = B: SH = SH + 1: EXIT SUB
IF SH = 9 THEN PUT (A, B), Q2: U9 = U9 * -1: F2 = A: B2 = B: SH = SH + 1: EXIT SUB
IF SH = 10 THEN PUT (A, B), Q3: UT = UT * -1: F3 = A: B3 = B: SH = SH + 1

END SUB

SUB SAVESCREEN

LOCATE 25, 1: PRINT "                                      ";
LOCATE 25, 1: PRINT "Saving TTALSCRN # "; NU; "- Wait";

FOR QL = 1 TO 7

A = 10: B = 10

DO WHILE C <> -1

IF QL = 1 THEN IF POINT(A, B + 8) = 6 THEN GOSUB 10        ' BLOCK
IF QL = 2 THEN IF POINT(A + 9, B + 6) = 6 THEN GOSUB 10    ' WIDEBLOCK
IF QL = 3 THEN IF POINT(A + 1, B + 39) = 8 THEN GOSUB 10   ' PILLAR
IF QL = 4 THEN IF POINT(A, B - 1) = 2 THEN GOSUB 10        ' GRASS
IF QL = 5 THEN IF POINT(A + 1, B + 6) = 2 THEN GOSUB 10    ' GREEN POTION
IF QL = 6 THEN IF POINT(A + 1, B + 6) = 3 THEN GOSUB 10    ' TURQUISE POTION
IF QL = 7 THEN IF POINT(A + 1, B + 6) = 13 THEN GOSUB 10   ' PINK POTION

IF QL <= 7 THEN A = A + 10

IF A > 300 THEN A = 10: B = B + 10
IF B > 180 THEN C = -1: GOSUB 10

LOOP
C = 0
NEXT

LOCATE 25, 1: PRINT "                                        ";
LOCATE 25, 1: SOUND 500, 9: PRINT "Editing TTALSCRN # "; NU;

     'CREATURE PLACEMENT HERE IN FUTURE

LOCATE 25, 1: PRINT "                                        ";
LOCATE 25, 1: SOUND 600, 9: INPUT "Done -- Press enter key to continue.", A$: CLS
A = 10: B = 180
EXIT SUB

10 'SAVE SCREEN
         
          A$ = "TTALSCRN" + STR$(NU)
          FOR QH = 1 TO LEN(A$)
          IF MID$(A$, QH, 1) = " " THEN MID$(A$, QH, 1) = "."
          NEXT
          IF QY <> 1 THEN KILL A$: QY = 1
          OPEN A$ FOR APPEND AS 1
    
     IF C = -1 THEN WRITE #1, -1, -1: GOTO 12
     WRITE #1, A, B
    
12 CLOSE 1

RETURN
END SUB

SUB SAVESCREENTWO

SH = 1

LOCATE 25, 1: PRINT "                                      ";
LOCATE 25, 1: PRINT "Saving TTALCREA # "; NU; "- Wait";

FOR QL = 1 TO 10

IF QL = 1 THEN TA = X1: TB = Y1: GOSUB 100   ' BADMAN1
IF QL = 2 THEN TA = X2: TB = Y2: GOSUB 100   ' BADMAN2
IF QL = 3 THEN TA = W1: TB = D1: GOSUB 100   ' DEMON1
IF QL = 4 THEN TA = W2: TB = D2: GOSUB 100   ' DEMON2
IF QL = 5 THEN TA = S1: TB = K1: GOSUB 100   ' GHOST1
IF QL = 6 THEN TA = S2: TB = K2: GOSUB 100   ' GHOST2
IF QL = 7 THEN TA = D: TB = L: GOSUB 100     ' DEMONLORD
IF QL = 8 THEN TA = F1: TB = B1: GOSUB 100   ' FIRE 1
IF QL = 9 THEN TA = F2: TB = B2: GOSUB 100   ' FIRE 2
IF QL = 10 THEN TA = F3: TB = B3: GOSUB 100  ' FIRE 3

NEXT

LOCATE 25, 1: PRINT "                                        ";
LOCATE 25, 1: SOUND 600, 9: INPUT "Done -- Press enter key to continue.", A$: CLS
A = 10: B = 180
EXIT SUB

100 'SAVE SCREEN
        
IF QL = 1 THEN IF X1 = 0 OR Y1 = 0 THEN TA = -1: TB = -1
IF QL = 2 THEN IF X2 = 0 OR Y2 = 0 THEN TA = -1: TB = -1
IF QL = 3 THEN IF W1 = 0 OR D1 = 0 THEN TA = -1: TB = -1
IF QL = 4 THEN IF W2 = 0 OR D2 = 0 THEN TA = -1: TB = -1
IF QL = 5 THEN IF S1 = 0 OR K1 = 0 THEN TA = -1: TB = -1
IF QL = 6 THEN IF S2 = 0 OR K2 = 0 THEN TA = -1: TB = -1
IF QL = 7 THEN IF D = 0 OR L = 0 THEN TA = -1: TB = -1
IF QL = 8 THEN IF F1 = 0 OR B1 = 0 THEN TA = -1: TB = -1
IF QL = 9 THEN IF F2 = 0 OR B2 = 0 THEN TA = -1: TB = -1
IF QL = 10 THEN IF F3 = 0 OR B3 = 0 THEN TA = -1: TB = -1

          A$ = "TTALCREA" + STR$(NU)
          FOR QH = 1 TO LEN(A$)
          IF MID$(A$, QH, 1) = " " THEN MID$(A$, QH, 1) = "."
          NEXT
          OPEN A$ FOR APPEND AS 2
          CLOSE 2
          IF QY <> 1 THEN KILL A$: QY = 1
          OPEN A$ FOR APPEND AS 2
   
     WRITE #2, TA, TB
   
120 CLOSE 2

RETURN

END SUB

